"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[314],{314:(F,m,u)=>{u.r(m),u.d(m,{CadprodutoPageModule:()=>E});var C=u(316),c=u(496),d=u(957),p=u(1379),P=u(9204),o=u(7404),h=u(7125),w=u(4979),b=u(3857),M=u(4747),f=u(9581);function S(i,a){if(1&i&&(o.j41(0,"ion-select-option",14),o.EFF(1),o.k0s()),2&i){const s=a.$implicit;o.Y8G("value",s),o.R7$(),o.JRh(s)}}const I=[{path:"",component:(()=>{var i;class a{constructor(e,r,n,t,l,v,g,D){this.combustivelService=e,this.route=r,this.combustivelDataService=n,this.alertController=t,this.router=l,this.bombaService=v,this.utilService=g,this.produtoService=D,this.newProduto={id:null,nome:"",idbicos:"",idbombas:"",preco:0,tipoproduto:"",status:!0,ehcombustivel:!0,ncm:"",anp:"",codigobarras:""},this.tiposproduto=["ETANOL","ETANOL_ADITIVADO","GASOLINA","GASOLINA_ADITIVADA","DIESEL,DIESEL_S500_ADITIVADO","DIESEL_ADITIVADO","DIESEL_S10_ADITIVADO","GASOLINA_PODIUM","GASOLINA_PREMIUM","GNV","ARLA32","QUEROSENE","GASOLINA_TROCA_OLEO","PONTUACAO","OUTRO"]}ngOnInit(){this.loadProduto()}loadProduto(){const e=this.combustivelDataService.getCombustivel();e&&(this.newProduto=e)}saveProduto(){var e=this;return(0,P.A)(function*(){if(!(e.newProduto.id&&e.newProduto.nome&&e.newProduto.preco&&e.newProduto.tipoproduto))return void(yield e.utilService.showAlert("Erro","Os campos (Id, nome, pre\xe7o, tipo produto) s\xe3o obrigat\xf3rios."));if(!/^\d+([.,]\d{1,2})?$/.test(e.newProduto.preco.toString()))return void(yield e.utilService.showAlert("Erro","O campo Pre\xe7o deve conter apenas n\xfameros e ponto, com no m\xe1ximo 4 casas decimais."));const n=e.combustivelDataService.getCombustivel();if(null!=(null==n?void 0:n.id)&&(null==n?void 0:n.id)!=e.newProduto.id)return void(yield e.utilService.showAlert("Erro","N\xe3o \xe9 permitido atualizar o c\xf3digo do produto."));const t=yield e.combustivelService.getCombustivelById(e.newProduto.id);if(t&&(null==n?void 0:n.id)>0)return void(yield e.utilService.showAlert("Erro",`O produto ${t.id} j\xe1 foi cadastrado.`));let l="";if(0!=e.newProduto.id&&null==t){const g=yield e.combustivelService.addCombustivel(e.newProduto.id,e.newProduto.nome,e.newProduto.idbicos,e.newProduto.idbombas,e.newProduto.preco,e.newProduto.tipoproduto,e.newProduto.status,e.newProduto.ehcombustivel,e.newProduto.ncm,e.newProduto.anp,e.newProduto.codigobarras);e.newProduto.id=g,l=`Produto ${g} - ${e.newProduto.nome} adicionado com sucesso!`}else yield e.combustivelService.updateCombustivel(e.newProduto.id,e.newProduto.nome,e.newProduto.idbicos,e.newProduto.idbombas,e.newProduto.preco,e.newProduto.tipoproduto,e.newProduto.status,e.newProduto.ehcombustivel,e.newProduto.ncm,e.newProduto.anp,e.newProduto.codigobarras),l=`Produto ${e.newProduto.id} - ${e.newProduto.nome} atualizado com sucesso!`;yield e.sincronizarProduto(),yield(yield e.alertController.create({header:"Sucesso",message:l,buttons:[{text:"OK",handler:()=>{e.router.navigate(["/produto"])}}]})).present()})()}voltarPagina(){this.router.navigate(["/produto"])}sincronizarProduto(){var e=this;return(0,P.A)(function*(){const r=yield e.retornaStatusString(e.newProduto.status),n={codigoProduto:e.newProduto.id.toString(),Descricao:e.newProduto.nome,tipoProduto:e.newProduto.tipoproduto,status:r,preco:e.utilService.verificarEConverterPreco(e.newProduto.preco),ehCombustivel:e.newProduto.ehcombustivel,ncm:e.newProduto.ncm,anp:e.newProduto.anp,codigoBarras:e.newProduto.codigobarras};try{const t=yield e.produtoService.sincronizarProdutoSingle(n);return console.log(`${JSON.stringify(n)}`),console.log(`TraceID: ${t.trace_Id}`),console.log(`statusCode: ${t.statusCode}`),!!(t.statusCode=200)||(yield e.utilService.showAlert("Erro",`N\xe3o foi poss\xedvel cancelar o desconto: ${t.errmsg}`),!1)}catch(t){return console.error("Erro ao sincronizar combust\xedvel:",t),yield e.utilService.showAlert("Erro",`N\xe3o foi poss\xedvel sincronizar o combust\xedvel: ${t}`),!1}})()}retornaStatusString(e){return(0,P.A)(function*(){return e?"ATIVO":"INATIVO"})()}}return(i=a).\u0275fac=function(e){return new(e||i)(o.rXU(h.j),o.rXU(p.nX),o.rXU(w.j),o.rXU(d.hG),o.rXU(p.Ix),o.rXU(b.J),o.rXU(M.a),o.rXU(f.N))},i.\u0275cmp=o.VBU({type:i,selectors:[["app-cadproduto"]],decls:39,vars:9,consts:[[3,"translucent"],["slot","start"],["position","stacked"],["placeholder","Digite o c\xf3digo do produto",3,"ngModelChange","ngModel"],["placeholder","Digite o nome",3,"ngModelChange","ngModel"],["lines","full"],["required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Digite o pre\xe7o",3,"ngModelChange","ngModel"],["placeholder","Digite o NCM",3,"ngModelChange","ngModel"],["placeholder","Digite o C\xf3digo de Barras",3,"ngModelChange","ngModel"],["labelPlacement","end","justify","start",3,"ngModelChange","ngModel"],["expand","block",3,"click"],["expand","block","color","secondary",3,"click"],[3,"value"]],template:function(e,r){1&e&&(o.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),o.nrm(3,"ion-menu-button"),o.k0s(),o.j41(4,"ion-title"),o.EFF(5,"Cadastro de Produto"),o.k0s()()(),o.j41(6,"ion-content")(7,"ion-item")(8,"ion-label",2),o.EFF(9,"C\xf3digo"),o.k0s(),o.j41(10,"ion-input",3),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.id,t)||(r.newProduto.id=t),t}),o.k0s()(),o.j41(11,"ion-item")(12,"ion-label",2),o.EFF(13,"Nome"),o.k0s(),o.j41(14,"ion-input",4),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.nome,t)||(r.newProduto.nome=t),t}),o.k0s()(),o.j41(15,"ion-item",5)(16,"ion-label",2),o.EFF(17,"Tipo de produto"),o.k0s(),o.j41(18,"ion-select",6),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.tipoproduto,t)||(r.newProduto.tipoproduto=t),t}),o.DNE(19,S,2,2,"ion-select-option",7),o.k0s()(),o.j41(20,"ion-item")(21,"ion-label",2),o.EFF(22,"Pre\xe7o"),o.k0s(),o.j41(23,"ion-input",8),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.preco,t)||(r.newProduto.preco=t),t}),o.k0s()(),o.j41(24,"ion-item")(25,"ion-label",2),o.EFF(26,"NCM"),o.k0s(),o.j41(27,"ion-input",9),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.ncm,t)||(r.newProduto.ncm=t),t}),o.k0s()(),o.j41(28,"ion-item")(29,"ion-label",2),o.EFF(30,"C\xf3digo de Barras"),o.k0s(),o.j41(31,"ion-input",10),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.codigobarras,t)||(r.newProduto.codigobarras=t),t}),o.k0s()(),o.j41(32,"ion-item")(33,"ion-checkbox",11),o.mxI("ngModelChange",function(t){return o.DH7(r.newProduto.status,t)||(r.newProduto.status=t),t}),o.EFF(34,"Status (Ativo ou Inativo) "),o.k0s()(),o.j41(35,"ion-button",12),o.bIt("click",function(){return r.saveProduto()}),o.EFF(36,"Gravar"),o.k0s(),o.j41(37,"ion-button",13),o.bIt("click",function(){return r.voltarPagina()}),o.EFF(38,"Cancelar"),o.k0s()()),2&e&&(o.Y8G("translucent",!0),o.R7$(10),o.R50("ngModel",r.newProduto.id),o.R7$(4),o.R50("ngModel",r.newProduto.nome),o.R7$(4),o.R50("ngModel",r.newProduto.tipoproduto),o.R7$(),o.Y8G("ngForOf",r.tiposproduto),o.R7$(4),o.R50("ngModel",r.newProduto.preco),o.R7$(4),o.R50("ngModel",r.newProduto.ncm),o.R7$(4),o.R50("ngModel",r.newProduto.codigobarras),o.R7$(2),o.R50("ngModel",r.newProduto.status))},dependencies:[C.Sq,c.BC,c.YS,c.vS,d.Jm,d.QW,d.eY,d.W9,d.eU,d.$w,d.uz,d.he,d.MC,d.Nm,d.Ip,d.BC,d.ai,d.hB,d.Je,d.Gw]}),a})()}];let A=(()=>{var i;class a{}return(i=a).\u0275fac=function(e){return new(e||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[p.iI.forChild(I),p.iI]}),a})(),E=(()=>{var i;class a{}return(i=a).\u0275fac=function(e){return new(e||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[C.MD,c.YN,d.bv,A]}),a})()}}]);
//# sourceMappingURL=314.33ec5cae3be1494b.js.map