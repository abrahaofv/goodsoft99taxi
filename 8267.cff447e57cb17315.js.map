{"version":3,"file":"8267.cff447e57cb17315.js","mappings":"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","names":["CupomDescontoService","_CupomDescontoService","constructor","http","configuracaoService","this","validarDesconto","cupomDesconto","_this","_asyncToGenerator","endpoint","getConfiguracaoUrlApi","headers","HttpHeaders","cupomObservable","post","firstValueFrom","i0","i1","i2","factory","ɵfac","providedIn","pagamento_r5","i_r2","_r1","index","ctx_r2","editDescontosTiposPagamento","deleteDescontosTiposPagamento","$event","item_r4","$implicit","tipopagamento","CaddescontoPage_ion_accordion_35_ion_select_option_16_Template","valorpago","formatValue","sugerirValorTotalAPagarDescontosTiposPagamento","pagamentos","i_r7","_r6","editDescontosCombustiveis","deleteDescontosCombustiveis","item_r8","idbomba","idbico","nome","preco","totallitros","totalprecocombustivel","totaldescontorecebidocombustivel","totaldescontocombustivel","routes","path","component","_CaddescontoPage","CaddescontoPage","descontoService","descontoDataService","alertController","cupomDescontoService","pedidoService","produtoService","router","utilService","gerarDadosRetornoIntegracaoService","combustivelService","desconto","totalpreco","totaldesconto","datahora","Date","numerorecibo","idpedidodidiglobal","codigodesconto","confirmado","totaldescontorecebido","cancelado","nomeatendente","descontosTiposPagamento","descontosCombustiveis","isNovoDesconto","isNovoDescontoCombustivel","isNovoDescontoTiposPagamento","isValid","ngOnInit","loadDesconto","desabilitaValidarDesconto","desabilitaAdicionarProduto","desabilitaCancelarDesconto","desabilitaGerarDesconto","desabilitaAdicionarPagamento","ngAfterViewInit","desabilitaEditarDeletarProduto","ionViewWillEnter","updateTotals","ionViewWillLeave","setDesconto","ngOnDestroy","getDesconto","id","getNomeAtendenteFromLocalStorage","getDescontosCombustiveis","getDescontoTiposPagamento","length","localStorage","getItem","saveNomeAtendenteToLocalStorage","setItem","addDescontosCombustiveis","_this2","clearCurrentDescontoCombustivel","navigate","_this3","setCurrentDescontoCombustivel","_this4","splice","parseFloat","reduce","sum","item","toFixed","_this5","showAlert","validaDescontoAPI","sincronizarCombustivel","saveDesconto","_this6","produto","getCombustivelById","idcombustivel","corpo","codigoProduto","toString","Descricao","tipoProduto","tipoproduto","status","verificarEConverterPreco","ehCombustivel","ehcombustivel","ncm","anp","codigoBarras","codigobarras","cupom","sincronizarProdutoSingle","console","log","JSON","stringify","trace_Id","statusCode","errmsg","error","errorMsg","HttpErrorResponse","message","validaPagamentos","_this7","totalValorPago","pagamento","mensagemErro","_this8","retornoApiConfirmaDesconto","ConfirmaDescontoAPI","iddesconto","addDescontoTiposPagamento","updateDescontoTiposPagamento","gerarDadosRetornoIntegracao","idDesconto","addDesconto","updateDesconto","addDescontoCombustivel","updateDescontoCombustivel","clear","resetForm","voltarPagina","cancelarDesconto","_this9","cancelaDescontoAPI","addDescontosTiposPagamento","_this10","push","_this11","_this12","value","_this13","test","desabilitado","_this14","gerarDesconto","document","getElementById","disabled","_this15","adicionarPagamento","_this16","_this17","_this18","btDeletarProdutos","btEditarProdutos","forEach","deletarProduto","editarProduto","_this19","adicionarProduto","generateGUID","s4","Math","floor","random","substring","_this20","itensApi","itensDescontosCombustiveis","itemApi","precoUnitario","quantidade","totalItem","nomeAtendente","codigoDesconto","valorTotalPedido","listaItensPedido","data","orderId","totalDiscountedOrderAmount","erroMsgApi","orderItems","orderItem","descontoCombustivel","productCode","discountAmount","_this21","itensDescontosTipoPagamento","tipo","valor","pedidoId","recibo","Pagamentos","confirmarPedido","_this22","Recibo","cancelarPedido","_this23","itensCorpo","SomaTotalDescontoRecebido","itemCorpo","idCombustivel","idBomba","idBico","totalLitros","totalPrecoCombustivel","totalDescontoCombustivel","totalDescontoRecebidoCombustivel","descontoPagamento","NomeAtendente","totalPreco","totalDesconto","dataHora","idPedidoDidiGlobal","totalDescontoRecebido","gerarDadosRetorno","arquivoGerado","i3","i4","i5","i6","i7","i8","i9","i10","selectors","viewQuery","rf","ctx","CaddescontoPage_ion_accordion_35_Template","CaddescontoPage_ion_accordion_37_Template","CaddescontoPageRoutingModule","_CaddescontoPageRoutingModule","RouterModule","forChild","CaddescontoPageModule","_CaddescontoPageModule","CommonModule","FormsModule","IonicModule"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./src/app/core/services/cupom-desconto.service.ts","./src/app/pages/cadastro/caddesconto/caddesconto.page.html","./src/app/pages/cadastro/caddesconto/caddesconto-routing.module.ts","./src/app/pages/cadastro/caddesconto/caddesconto.page.ts","./src/app/pages/cadastro/caddesconto/caddesconto.module.ts"],"sourcesContent":["// src\\app\\core\\services\\cupom-desconto.service.ts\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { firstValueFrom } from 'rxjs';\r\nimport { CupomDescontoRequest } from 'src/app/shared/models/cupomdesconto.request.model';\r\nimport { CupomDesconto } from 'src/app/shared/models/cupomdesconto.model';\r\nimport { ConfiguracaoService } from 'src/app/services/configuracao/configuracao.service';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CupomDescontoService {\r\n  constructor(\r\n    private http: HttpClient,\r\n    private configuracaoService: ConfiguracaoService) {}\r\n\r\n  async validarDesconto(cupomDesconto: CupomDescontoRequest): Promise<CupomDesconto> {     \r\n    const apiUrl = await this.configuracaoService.getConfiguracaoUrlApi();\r\n    const endpoint = apiUrl + 'ValidarCupomDesconto';\r\n    const headers = new HttpHeaders({ 'Content-Type': 'application/json' });\r\n    const cupomObservable = this.http.post<CupomDesconto>(endpoint, cupomDesconto, { headers });\r\n    return await firstValueFrom(cupomObservable);\r\n  }\r\n}\r\n","<ion-header [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-buttons slot=\"start\">\r\n      <ion-menu-button></ion-menu-button>\r\n    </ion-buttons>\r\n    <ion-title>Cadastro de Desconto</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Código de Desconto</ion-label>\r\n    <ion-input [(ngModel)]=\"desconto.codigodesconto\" placeholder=\"Digite o código do desconto\" required></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Recibo</ion-label>\r\n    <ion-input [(ngModel)]=\"desconto.numerorecibo\" type=\"text\" placeholder=\"Digite o recibo\"></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Nome do Atendente</ion-label>\r\n    <ion-input [(ngModel)]=\"desconto.nomeatendente\" placeholder=\"Digite o nome do atendente\"></ion-input>\r\n  </ion-item>  \r\n\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Total Preço</ion-label>\r\n    <ion-input [value]=\"desconto.totalpreco | number: '1.2-2'\" readonly></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Total Desconto Recebido</ion-label>\r\n    <ion-input [value]=\"desconto.totaldescontorecebido | number: '1.2-2'\" readonly></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-item lines=\"full\">\r\n    <ion-label position=\"stacked\">Total com Desconto</ion-label>\r\n    <ion-input [value]=\"desconto.totaldesconto | number: '1.2-2'\" readonly></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-accordion-group>\r\n    <ion-accordion *ngFor=\"let item of descontosTiposPagamento; let i = index\">\r\n      <ion-item slot=\"header\">\r\n        <ion-label>\r\n          Tipo de Pagamento: {{ item.tipopagamento }}, Valor Pago: {{ item.valorpago }}\r\n        </ion-label>\r\n        <ion-buttons slot=\"end\">\r\n          <ion-button #btEditarProduto (click)=\"editDescontosTiposPagamento(i)\">Editar</ion-button>\r\n          <ion-button #btDeletarProduto color=\"danger\" (click)=\"deleteDescontosTiposPagamento(i)\">Deletar</ion-button>\r\n        </ion-buttons>\r\n      </ion-item>\r\n      <ion-list slot=\"content\">\r\n        <ion-item>\r\n          <ion-label position=\"stacked\">Tipo de Pagamento</ion-label>\r\n          <ion-select [(ngModel)]=\"item.tipopagamento\" required>\r\n            <ion-select-option *ngFor=\"let pagamento of pagamentos\" [value]=\"pagamento\">{{ pagamento }}</ion-select-option>\r\n          </ion-select>\r\n          <ion-label position=\"stacked\">Valor Pago</ion-label>\r\n          <ion-input [(ngModel)]=\"item.valorpago\" placeholder=\"Digite o valor pago\" type=\"number\" (ngModelChange)=\"formatValue($event)\"></ion-input>\r\n          <ion-buttons slot=\"end\">\r\n            <ion-button color=\"primary\" (click)=\"sugerirValorTotalAPagarDescontosTiposPagamento(item)\">Preencher Valor Total a Pagar</ion-button>  \r\n          </ion-buttons>\r\n        </ion-item>        \r\n      </ion-list>\r\n    </ion-accordion>\r\n  </ion-accordion-group>  \r\n\r\n  <ion-accordion-group>\r\n    <ion-accordion *ngFor=\"let item of descontosCombustiveis; let i = index\">\r\n      <ion-item slot=\"header\">\r\n        <ion-label>\r\n          Bomba: {{ item.idbomba }}, Bico: {{ item.idbico }}, Combustível: {{ item.nome }}\r\n        </ion-label>\r\n        <ion-buttons slot=\"end\">\r\n          <ion-button #btEditarProduto (click)=\"editDescontosCombustiveis(i)\">Editar</ion-button>\r\n          <ion-button #btDeletarProduto color=\"danger\" (click)=\"deleteDescontosCombustiveis(i)\">Deletar</ion-button>\r\n        </ion-buttons>\r\n      </ion-item>\r\n      <ion-list slot=\"content\">\r\n        <ion-item>\r\n          <ion-label>\r\n            <p>Preço: R${{ item.preco }}</p>\r\n            <p>Total de litros abastecidos: {{ item.totallitros | number: '1.2-2'}}</p>\r\n            <p>Total sem desconto: R${{ item.totalprecocombustivel | number: '1.2-2'}}</p>\r\n            <p>Total de desconto recebido: R${{ item.totaldescontorecebidocombustivel | number: '1.2-2'}}</p>            \r\n            <p color=\"danger\">Total com desconto: R${{ item.totaldescontocombustivel | number: '1.2-2'}}</p>\r\n          </ion-label>\r\n        </ion-item>        \r\n      </ion-list>\r\n    </ion-accordion>\r\n  </ion-accordion-group>\r\n\r\n  <!-- Botão Adicionar Produto -->\r\n  <ion-button expand=\"block\" id=\"btAdicionarProduto\" (click)=\"addDescontosCombustiveis()\">Adicionar Produto</ion-button>\r\n  <!-- Botão Validar Desconto -->\r\n  <ion-button expand=\"block\" color=\"secondary\" id=\"btValidarDesconto\" (click)=\"validarDesconto()\">Validar Desconto</ion-button>\r\n  <!-- Botão Adicionar Pagamento -->\r\n  <ion-button expand=\"block\" id=\"btAdicionarPagamento\" (click)=\"addDescontosTiposPagamento()\">Adicionar Tipo de Pagamento</ion-button>\r\n  <!-- Botão Gerar Desconto -->\r\n  <ion-button expand=\"block\" id=\"btGerarDesconto\" (click)=\"saveDesconto()\">Confirmar Desconto</ion-button>\r\n  <!-- Botão Cancelar Desconto -->\r\n  <ion-button expand=\"block\" color=\"danger\" id=\"btCancelarDesconto\" (click)=\"cancelarDesconto()\">Cancelar Desconto</ion-button>\r\n</ion-content>\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CaddescontoPage } from './caddesconto.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CaddescontoPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class CaddescontoPageRoutingModule {}\n","// src\\app\\pages\\cadastro\\caddesconto\\caddesconto.page.ts\r\n\r\nimport { Component, OnInit, OnDestroy, ViewChildren, QueryList, AfterViewInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { DescontoService } from '../../../services/desconto/desconto.service';\r\nimport { DescontoDataService } from '../../../services/desconto-data/desconto-data.service';\r\nimport { Desconto, DescontosCombustiveis, DescontoTiposPagamento } from '../../../services/database.service';\r\nimport { UtilService } from '../../../services/util/util.service';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { sincronizarProdutoSingleRequest } from '../../../shared/models/sincronizarProdutoSingle.request.model';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { confirmarPedidoRequest, ConfirmarPedidoRequestPagamento } from 'src/app/shared/models/confirmarPedido.request.model';\r\nimport { Pedido } from 'src/app/shared/models/pedido.model';\r\nimport { PedidoService } from 'src/app/core/services/pedido.service';\r\nimport { ProdutoService } from 'src/app/core/services/produto.service';\r\n\r\nimport { CupomDescontoRequest, CupomDescontoRequestProduto } from 'src/app/shared/models/cupomdesconto.request.model';\r\nimport { CupomDesconto } from 'src/app/shared/models/cupomdesconto.model';\r\nimport { CupomDescontoService } from 'src/app/core/services/cupom-desconto.service';\r\nimport { CombustivelService } from 'src/app/services/combustivel/combustivel.service';\r\n\r\nimport { cancelarPedidoRequest } from 'src/app/shared/models/cancelarPedido.request.model';\r\n\r\nimport {GerarDadosRetornoIntegracaoRequest, GerarDadosRetornoIntegracaoDescontoCombustivelRequest, GerarDadosRetornoIntegracaoPagamentoPedidoRequest} from '../../../shared/models/gerarDadosRetornoIntegracaoRequest';\r\nimport { GerarDadosRetornoIntegracaoService } from 'src/app/core/services/gerar-dados-retorno-integracao.service';\r\n\r\n@Component({\r\n  selector: 'app-caddesconto',\r\n  templateUrl: './caddesconto.page.html',\r\n  styleUrls: ['./caddesconto.page.scss']\r\n})\r\nexport class CaddescontoPage implements OnInit, OnDestroy, AfterViewInit {\r\n  desconto: Desconto = {\r\n    totalpreco: 0,\r\n    totaldesconto: 0,\r\n    datahora: new Date(),\r\n    numerorecibo: null,\r\n    idpedidodidiglobal: '',\r\n    codigodesconto: '',\r\n    confirmado: false,\r\n    totaldescontorecebido: 0,\r\n    cancelado: false,\r\n    nomeatendente: '',\r\n  };\r\n  \r\n  descontosTiposPagamento: DescontoTiposPagamento[] = [];\r\n  descontosCombustiveis: DescontosCombustiveis[] = [];\r\n  \r\n  pagamentos: string[] = ['Pix', 'Dinheiro', 'Cartão de débito', 'Cartão de crédito', 'Carteiras digitais', 'Cheque'];\r\n  isNovoDesconto: boolean = true;\r\n  isNovoDescontoCombustivel: boolean = true;\r\n  isNovoDescontoTiposPagamento: boolean = true;\r\n  isValid: boolean = false;\r\n\r\n  SomaTotalDescontoRecebido: number;\r\n  \r\n  responseDesconto: CupomDesconto;\r\n  erroMsgApi: string;\r\n\r\n  @ViewChildren('btDeletarProduto') btDeletarProdutos: QueryList<HTMLIonButtonElement>;\r\n  @ViewChildren('btEditarProduto') btEditarProdutos: QueryList<HTMLIonButtonElement>;\r\n\r\n  constructor(\r\n    private descontoService: DescontoService,\r\n    private descontoDataService: DescontoDataService,\r\n    private alertController: AlertController,\r\n    private cupomDescontoService: CupomDescontoService,\r\n    private pedidoService: PedidoService,\r\n    private produtoService: ProdutoService,\r\n    private router: Router,\r\n    private utilService: UtilService,\r\n    private gerarDadosRetornoIntegracaoService: GerarDadosRetornoIntegracaoService,\r\n    private combustivelService : CombustivelService,\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.loadDesconto();\r\n    this.desabilitaValidarDesconto(false);\r\n    this.desabilitaAdicionarProduto(false);\r\n    this.desabilitaCancelarDesconto(true);\r\n    this.desabilitaGerarDesconto(true);\r\n    this.desabilitaAdicionarPagamento(true);\r\n    //this.desabilitaEditarDeletarProduto(true);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.desabilitaEditarDeletarProduto(true);\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.loadDesconto();\r\n    this.updateTotals();\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.descontoDataService.setDesconto(this.desconto);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.descontoDataService.setDesconto(this.desconto);\r\n  }\r\n\r\n  async loadDesconto() {\r\n    const desconto = this.descontoDataService.getDesconto();\r\n    if (desconto) {\r\n      this.desconto = desconto;\r\n      this.isNovoDesconto = !this.desconto.id;  // Se o ID está presente, não é um novo desconto\r\n      this.isNovoDescontoCombustivel = this.isNovoDesconto;      \r\n    } else {\r\n      this.isNovoDesconto = true;  // Se não há desconto carregado, é um novo desconto\r\n      this.isNovoDescontoCombustivel = true;\r\n      this.desconto.nomeatendente = this.getNomeAtendenteFromLocalStorage();\r\n    }\r\n    this.descontosCombustiveis = this.descontoDataService.getDescontosCombustiveis();\r\n    this.descontosTiposPagamento = this.descontoDataService.getDescontoTiposPagamento();\r\n    this.isNovoDescontoTiposPagamento = this.descontosTiposPagamento.length <= 0;\r\n    this.updateTotals();\r\n  }\r\n\r\n  getNomeAtendenteFromLocalStorage(): string {\r\n    return localStorage.getItem('nomeatendente') || '';\r\n  }\r\n\r\n  saveNomeAtendenteToLocalStorage(nomeatendente: string) {\r\n    localStorage.setItem('nomeatendente', nomeatendente);\r\n  }\r\n\r\n  async addDescontosCombustiveis() {\r\n    this.descontoDataService.clearCurrentDescontoCombustivel();\r\n    this.router.navigate(['/caddescontoscombustiveis']);\r\n  }\r\n\r\n  async editDescontosCombustiveis(index: number) {\r\n    const descontosCombustiveis = this.descontosCombustiveis[index];\r\n    this.descontoDataService.setCurrentDescontoCombustivel(descontosCombustiveis, index);\r\n    this.router.navigate(['/caddescontoscombustiveis']);\r\n  }\r\n\r\n  async deleteDescontosCombustiveis(index: number) {\r\n    this.descontosCombustiveis.splice(index, 1);\r\n    this.updateTotals();\r\n  }\r\n\r\n  updateTotals() {\r\n    this.desconto.totalpreco = parseFloat(this.descontosCombustiveis\r\n      .reduce((sum, item) => sum + item.totalprecocombustivel, 0)\r\n      .toFixed(2));\r\n    this.desconto.totaldesconto = parseFloat(this.descontosCombustiveis\r\n      .reduce((sum, item) => sum + item.totaldescontocombustivel, 0)\r\n      .toFixed(2));\r\n      this.desconto.totaldescontorecebido = parseFloat(this.descontosCombustiveis\r\n        .reduce((sum, item) => sum + item.totaldescontorecebidocombustivel, 0)\r\n        .toFixed(2));\r\n  }\r\n\r\n  // Valida Desconto\r\n  async validarDesconto(): Promise<boolean> {\r\n    if (!this.desconto.codigodesconto) {\r\n      await this.utilService.showAlert('Erro', 'Código do Desconto obrigatório.');\r\n      return false;\r\n    }\r\n\r\n    //if (this.descontosTiposPagamento.length <= 0) {\r\n    //  await this.utilService.showAlert('Erro', 'Informe pelo menos uma forma de pagamento.');\r\n    //  return false;\r\n    //}\r\n\r\n    if (this.descontosCombustiveis.length === 0) {\r\n      await this.utilService.showAlert('Erro', 'Adicione pelo menos um item ao desconto.');\r\n      return false;\r\n    }\r\n\r\n    const retornoApivalidarDesconto = await this.validaDescontoAPI();\r\n    if (!retornoApivalidarDesconto){\r\n      return false;\r\n    }\r\n\r\n    this.desabilitaAdicionarProduto(true);\r\n    this.desabilitaValidarDesconto(true);\r\n    this.desabilitaGerarDesconto(false);\r\n    this.desabilitaAdicionarPagamento(false);\r\n    this.desabilitaEditarDeletarProduto(true);\r\n\r\n    if (this.isNovoDesconto){\r\n      await this.sincronizarCombustivel();\r\n    }  \r\n\r\n    await this.saveDesconto(false); \r\n\r\n    await this.utilService.showAlert('Sucesso', `Desconto validado com sucesso.`);\r\n\r\n    return true;\r\n  }\r\n\r\n  async sincronizarCombustivel(){\r\n    const statusString = 'ATIVO';\r\n\r\n    for (const item of this.descontosCombustiveis) {\r\n      const produto = await this.combustivelService.getCombustivelById(item.idcombustivel);\r\n\r\n      const corpo: sincronizarProdutoSingleRequest = {\r\n        codigoProduto: produto.id.toString(),\r\n        Descricao: produto.nome,\r\n        tipoProduto: produto.tipoproduto,\r\n        status: statusString,\r\n        preco: this.utilService.verificarEConverterPreco(produto.preco),\r\n        ehCombustivel: produto.ehcombustivel,\r\n        ncm : produto.ncm.toString(),\r\n        anp: produto.anp.toString(),\r\n        codigoBarras: produto.codigobarras.toString(),\r\n      };\r\n      \r\n      try {\r\n        const cupom = await this.produtoService.sincronizarProdutoSingle(corpo);\r\n        \r\n        console.log(`${JSON.stringify(corpo)}`);\r\n        console.log(`TraceID sincronizarCombustivel: ${cupom.trace_Id}`);\r\n        console.log(`statusCode: ${cupom.statusCode}`);\r\n  \r\n        if (cupom.statusCode != 200){\r\n          await this.utilService.showAlert('Erro', `Não foi possível sincronizar o combustível: ${cupom.errmsg}`);\r\n        }   \r\n      } catch (error) {\r\n        console.error('Erro ao sincronizar combustível:', error);\r\n  \r\n        // Extraia a mensagem de erro correta do objeto error\r\n        let errorMsg = 'Erro desconhecido';\r\n        if (error instanceof HttpErrorResponse) {\r\n          if (error.error && typeof error.error === 'object' && 'errmsg' in error.error) {\r\n            errorMsg = error.error.errmsg;\r\n          } else if (error.message) {\r\n            errorMsg = error.message;\r\n          }\r\n        }\r\n  \r\n        await this.utilService.showAlert('Erro', `Não foi possível sincronizar o combustível: ${errorMsg}`);\r\n      }\r\n    }    \r\n  }\r\n\r\n  // Valida Pagamentos\r\n  async validaPagamentos(): Promise<boolean>{\r\n    console.log(`Entrou validaPagamentos`);\r\n\r\n    const totalValorPago = this.descontosTiposPagamento\r\n      .reduce((sum, pagamento) => sum + pagamento.valorpago, 0);\r\n  \r\n    if (totalValorPago !== this.desconto.totaldesconto) {\r\n      const mensagemErro = totalValorPago < this.desconto.totaldesconto \r\n        ? `O valor total pago(${totalValorPago}) é menor que o total do desconto(${this.desconto.totaldesconto}).`\r\n        : `O valor total pago(${totalValorPago}) é maior que o total do desconto(${this.desconto.totaldesconto}).`;\r\n      await await this.utilService.showAlert('Erro', mensagemErro);\r\n      return false;\r\n    }\r\n  \r\n    return true;\r\n  }\r\n\r\n  // Confirma Desconto\r\n  async saveDesconto(confirmado: boolean = true){\r\n\r\n    console.log(`saveDesconto - idpedidodidiglobal: ${this.desconto.idpedidodidiglobal}`);\r\n    console.log(`saveDesconto - numerorecibo: ${this.desconto.numerorecibo}`);\r\n    console.log(`saveDesconto - cancelado: ${this.desconto.cancelado}`);\r\n\r\n    if (!this.desconto.numerorecibo && !this.isNovoDesconto) {\r\n      await this.utilService.showAlert('Erro', 'Obrigatório informar o recibo para geração do desconto.');\r\n      return;\r\n    }\r\n\r\n    this.desconto.datahora = new Date();\r\n    this.saveNomeAtendenteToLocalStorage(this.desconto.nomeatendente);\r\n    this.updateTotals();\r\n\r\n    if (confirmado && this.desconto.idpedidodidiglobal && this.desconto.numerorecibo && !this.desconto.cancelado){\r\n      const pagamentoValidado = await this.validaPagamentos();\r\n      if (!pagamentoValidado){\r\n        return;\r\n      }\r\n           \r\n      const retornoApiConfirmaDesconto = await this.ConfirmaDescontoAPI();\r\n      if (!retornoApiConfirmaDesconto){\r\n        return;\r\n      } else {\r\n        //Salva tipo pagamento\r\n        if (this.descontosTiposPagamento.length > 0){\r\n          for (const item of this.descontosTiposPagamento) {\r\n            item.iddesconto = this.desconto.id!;\r\n            if (this.isNovoDescontoTiposPagamento) {\r\n              item.id = await this.descontoService.addDescontoTiposPagamento(item);\r\n            } else {\r\n              item.id = await this.descontoService.updateDescontoTiposPagamento(item);\r\n            }\r\n          }\r\n    \r\n          if (this.isNovoDescontoTiposPagamento){\r\n            this.isNovoDescontoTiposPagamento = false;\r\n          }\r\n        }\r\n\r\n        //Envia arquivo de retorno\r\n        if (retornoApiConfirmaDesconto){\r\n          const retornoGeraDados = await this.gerarDadosRetornoIntegracao();\r\n          if(!retornoGeraDados){\r\n            return;\r\n          }\r\n        }   \r\n      }\r\n    }        \r\n\r\n    console.log(`saveDesconto - confirmado: ${this.desconto.confirmado}`);\r\n    \r\n    let idDesconto;\r\n    if (this.isNovoDesconto) {\r\n      idDesconto = await this.descontoService.addDesconto(\r\n        this.desconto.totalpreco,\r\n        this.desconto.totaldesconto,\r\n        this.desconto.datahora,\r\n        this.desconto.numerorecibo,\r\n        this.desconto.idpedidodidiglobal,\r\n        this.desconto.codigodesconto,\r\n        this.desconto.confirmado,\r\n        this.desconto.totaldescontorecebido,\r\n        this.desconto.cancelado,\r\n        this.desconto.nomeatendente\r\n      );\r\n      this.desconto.id = idDesconto;\r\n      this.isNovoDesconto = false;\r\n    } else {\r\n      idDesconto = this.desconto.id!;\r\n      await this.descontoService.updateDesconto(\r\n        this.desconto.id,\r\n        this.desconto.totalpreco,\r\n        this.desconto.totaldesconto,\r\n        this.desconto.datahora,\r\n        this.desconto.numerorecibo,\r\n        this.desconto.idpedidodidiglobal,\r\n        this.desconto.codigodesconto,\r\n        this.desconto.confirmado,\r\n        this.desconto.totaldescontorecebido,\r\n        this.desconto.cancelado,\r\n        this.desconto.nomeatendente\r\n      );\r\n    }\r\n\r\n    for (const item of this.descontosCombustiveis) {\r\n      item.iddesconto = idDesconto;\r\n      if (this.isNovoDescontoCombustivel) {\r\n        item.id = await this.descontoService.addDescontoCombustivel(item);\r\n      } else {\r\n        item.id = await this.descontoService.updateDescontoCombustivel(item);\r\n      }\r\n    }   \r\n\r\n    if (this.isNovoDescontoCombustivel){\r\n      this.isNovoDescontoCombustivel = false;\r\n    } \r\n\r\n    if (confirmado){      \r\n      this.descontoDataService.clear();\r\n      this.resetForm(); // Limpar os campos após salvar\r\n      await this.utilService.showAlert('Sucesso', `Desconto gerado com sucesso.`);\r\n      this.router.navigate(['/desconto']);\r\n    }\r\n  }\r\n\r\n  resetForm() {\r\n    this.desconto = {\r\n      totalpreco: 0,\r\n      totaldesconto: 0,\r\n      datahora: new Date(),\r\n      numerorecibo: '',\r\n      idpedidodidiglobal: '',\r\n      codigodesconto: '',\r\n      confirmado: false,\r\n      totaldescontorecebido: 0,\r\n      cancelado: false,\r\n      nomeatendente: '',\r\n    };\r\n    this.descontosCombustiveis = [];\r\n    this.descontosTiposPagamento = [];\r\n    this.isNovoDesconto = true;\r\n    this.isNovoDescontoCombustivel = true;\r\n    this.isNovoDescontoTiposPagamento = true;\r\n  }\r\n\r\n  voltarPagina() {\r\n    this.descontoDataService.clear();\r\n    this.router.navigate(['/desconto']);\r\n  }\r\n\r\n  // Cancela Desconto\r\n  async cancelarDesconto() {    \r\n    const retornoApiCancelaDesconto = await this.cancelaDescontoAPI();\r\n    if (!retornoApiCancelaDesconto){\r\n      return;\r\n    }\r\n\r\n    const retornoGeraDados = await this.gerarDadosRetornoIntegracao();\r\n    if(!retornoGeraDados){\r\n      return;\r\n    }\r\n  \r\n    this.desconto.cancelado = true;\r\n    await this.saveDesconto(false);\r\n    await this.utilService.showAlert('Sucesso', `Desconto cancelado com sucesso.`);\r\n    this.voltarPagina();\r\n  }  \r\n\r\n  // Tipo Pagamento\r\n  async addDescontosTiposPagamento() {\r\n    this.descontosTiposPagamento.push({\r\n      iddesconto: this.desconto.id!,\r\n      tipopagamento: '',\r\n      valorpago: 0.00\r\n    });\r\n  }\r\n\r\n  async editDescontosTiposPagamento(index: number) {\r\n\r\n  }\r\n\r\n  async deleteDescontosTiposPagamento(index: number) {\r\n    this.descontosTiposPagamento.splice(index, 1);\r\n  }\r\n\r\n  async sugerirValorTotalAPagarDescontosTiposPagamento(item: DescontoTiposPagamento){\r\n    item.valorpago = this.desconto.totaldesconto; \r\n  }\r\n\r\n  async formatValue(value: number){\r\n    const valorRegex = /^\\d+([.,]\\d{1,2})?$/;\r\n    \r\n    // Validação preço\r\n    if (!valorRegex.test(value?.toString())) {\r\n      await this.utilService.showAlert('Erro', 'O campo Preço deve conter apenas números e ponto, com no máximo 2 casas decimais.');\r\n      return;\r\n    }\r\n  }\r\n\r\n  //#region Métodos Desabilita Botões\r\n  // Desabilita o botão gerar desconto\r\n  async desabilitaGerarDesconto(desabilitado: boolean) {    \r\n    const gerarDesconto = document.getElementById('btGerarDesconto') as HTMLIonSelectElement;\r\n    if (gerarDesconto) {\r\n      if (this.desconto.cancelado)\r\n        gerarDesconto.disabled = true;\r\n      else if (this.desconto.idpedidodidiglobal != '' && this.desconto.id > 0 && this.desconto.confirmado == false)\r\n        gerarDesconto.disabled = false;\r\n      else\r\n        gerarDesconto.disabled = desabilitado;\r\n    }\r\n  }\r\n\r\n  // Desabilita o botão Adicionar Pagamento\r\n  async desabilitaAdicionarPagamento(desabilitado: boolean) {    \r\n    const adicionarPagamento = document.getElementById('btAdicionarPagamento') as HTMLIonSelectElement;\r\n    if (adicionarPagamento) {\r\n      if (this.desconto.cancelado)\r\n        adicionarPagamento.disabled = true;\r\n      else if (this.desconto.idpedidodidiglobal != '' && this.desconto.id > 0 && this.desconto.confirmado == false)\r\n        adicionarPagamento.disabled = false;\r\n      else\r\n        adicionarPagamento.disabled = desabilitado;\r\n    }\r\n  }\r\n\r\n  // Desabilita o botão validar desconto\r\n  async desabilitaValidarDesconto(desabilitado: boolean) {\r\n    const validarDesconto = document.getElementById('btValidarDesconto') as HTMLIonSelectElement;\r\n    if (validarDesconto) {\r\n      if (this.desconto.cancelado)\r\n        validarDesconto.disabled = true;\r\n      else if (this.desconto.idpedidodidiglobal == '' && this.desconto.id <= 0)\r\n        validarDesconto.disabled = false;\r\n      else if (this.desconto.idpedidodidiglobal != '' && this.desconto.id > 0)\r\n        validarDesconto.disabled = true;\r\n      else\r\n        validarDesconto.disabled = desabilitado;\r\n    }    \r\n  }\r\n  \r\n  // Desabilita o botão cancelar desconto\r\n  async desabilitaCancelarDesconto(desabilitado: boolean) {    \r\n    const cancelarDesconto = document.getElementById('btCancelarDesconto') as HTMLIonSelectElement;\r\n    if (cancelarDesconto) {\r\n      if (this.desconto.cancelado)\r\n        cancelarDesconto.disabled = true;\r\n      else if (this.desconto.id > 0 && this.desconto.confirmado == true)\r\n        cancelarDesconto.disabled = false\r\n      else\r\n        cancelarDesconto.disabled = desabilitado;\r\n    }\r\n  }   \r\n\r\n  // Desabilita o botão deletar produto/combustível\r\n  async desabilitaEditarDeletarProduto(desabilitado: boolean) {\r\n    if (this.btDeletarProdutos && this.btEditarProdutos) {\r\n      this.btDeletarProdutos.forEach(deletarProduto => {\r\n        if (this.desconto.idpedidodidiglobal != '')\r\n          deletarProduto.disabled = true;\r\n        else\r\n          deletarProduto.disabled = desabilitado;\r\n      });\r\n\r\n      this.btEditarProdutos.forEach(editarProduto => {\r\n        if (this.desconto.idpedidodidiglobal != '')\r\n          editarProduto.disabled = true;\r\n        else\r\n          editarProduto.disabled = desabilitado;\r\n      });\r\n    }\r\n  }\r\n\r\n  // Desabilita o botão Adicionar Produto\r\n  async desabilitaAdicionarProduto(desabilitado: boolean) {\r\n    const adicionarProduto = document.getElementById('btAdicionarProduto') as HTMLIonSelectElement;\r\n    if (adicionarProduto) {\r\n      if (this.desconto.cancelado)\r\n        adicionarProduto.disabled = true;\r\n      else if (this.desconto.idpedidodidiglobal == '' && this.desconto.id <= 0)\r\n        adicionarProduto.disabled = false;\r\n      else if (this.desconto.idpedidodidiglobal != '' && this.desconto.id > 0)\r\n        adicionarProduto.disabled = true;\r\n      else\r\n        adicionarProduto.disabled = desabilitado;\r\n    }    \r\n  }  \r\n  //#endregion\r\n\r\n  private generateGUID(): string {\r\n    function s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\r\n    }\r\n    return `${s4()}${s4()}-${s4()}-${s4()}-${s4()}-${s4()}${s4()}${s4()}`;\r\n  }  \r\n\r\n  //#region Métodos API\r\n  // Valida Desconto já nossa api com DidiGlobal\r\n  async validaDescontoAPI(): Promise<boolean>{\r\n    const itensApi: CupomDescontoRequestProduto[] = []; // Inicializa o array de itens\r\n\r\n    for (const itensDescontosCombustiveis of this.descontosCombustiveis) {\r\n\r\n      const itemApi: CupomDescontoRequestProduto = {\r\n        codigoProduto: itensDescontosCombustiveis.idcombustivel.toString(),\r\n        precoUnitario: this.utilService.verificarEConverterPreco(itensDescontosCombustiveis.preco),\r\n        quantidade: itensDescontosCombustiveis.totallitros,\r\n        totalItem: itensDescontosCombustiveis.totalprecocombustivel,\r\n      };      \r\n\r\n      itensApi.push(itemApi); // Adiciona o item ao array\r\n    }\r\n\r\n    const corpo: CupomDescontoRequest = {\r\n      nomeAtendente: this.desconto.nomeatendente,\r\n      codigoDesconto: this.desconto.codigodesconto,\r\n      valorTotalPedido: this.desconto.totalpreco,\r\n      listaItensPedido: itensApi,\r\n    };\r\n\r\n    try{\r\n      const cupom = await this.cupomDescontoService.validarDesconto(corpo);\r\n\r\n      console.log(`${JSON.stringify(corpo)}`);\r\n      console.log(`TraceId ValidarDesconto: ${cupom.trace_Id}`);\r\n      console.log(`statusCode: ${cupom.statusCode}`);\r\n\r\n      if(cupom.statusCode != 200){\r\n        await this.utilService.showAlert('Erro', `Não foi possível validar o desconto: ${cupom.errmsg}`);\r\n        return false;\r\n      };       \r\n\r\n      this.desconto.idpedidodidiglobal = cupom.data.orderId;   \r\n      this.desconto.totaldesconto = cupom.data.totalDiscountedOrderAmount;\r\n      this.erroMsgApi = cupom.errmsg;\r\n\r\n      cupom.data.orderItems.forEach(orderItem => {\r\n        this.descontosCombustiveis.forEach(descontoCombustivel => {\r\n          if (descontoCombustivel.idcombustivel.toString() === orderItem.productCode) {\r\n            descontoCombustivel.totaldescontocombustivel = descontoCombustivel.totalprecocombustivel - orderItem.discountAmount;\r\n            descontoCombustivel.totaldescontorecebidocombustivel = orderItem.discountAmount;\r\n          }\r\n        });\r\n      });\r\n\r\n      return true;\r\n    }catch (error){\r\n      console.error('Erro ao validar cupom:', error);\r\n      \r\n    // Extraia a mensagem de erro correta do objeto error\r\n    let errorMsg = 'Erro desconhecido';\r\n    if (error instanceof HttpErrorResponse) {\r\n      if (error.error && typeof error.error === 'object' && 'errmsg' in error.error) {\r\n        errorMsg = error.error.errmsg;\r\n      } else if (error.message) {\r\n        errorMsg = error.message;\r\n      }\r\n    }\r\n\r\n      await this.utilService.showAlert('Erro', `Não foi possível validar o desconto: ${errorMsg}`);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Confirma Desconto já nossa api com DidiGlobal\r\n  async ConfirmaDescontoAPI(): Promise<boolean>{\r\n    const itensApi: ConfirmarPedidoRequestPagamento[] = []; // Inicializa o array de pagamentos\r\n\r\n    for (const itensDescontosTipoPagamento of this.descontosTiposPagamento){\r\n\r\n      const itemApi: ConfirmarPedidoRequestPagamento = {\r\n        tipo : itensDescontosTipoPagamento.tipopagamento,\r\n        valor: itensDescontosTipoPagamento.valorpago\r\n      }\r\n\r\n      itensApi.push(itemApi); // Adiciona o item ao array\r\n    }\r\n\r\n    const corpo: confirmarPedidoRequest = {\r\n      pedidoId: this.desconto.idpedidodidiglobal,\r\n      recibo: this.desconto.numerorecibo.toString(),\r\n      Pagamentos : itensApi\r\n    };\r\n\r\n    try {\r\n      const cupom = await this.pedidoService.confirmarPedido(corpo);\r\n\r\n      console.log(`${JSON.stringify(corpo)}`);\r\n      console.log(`TraceID ConfirmaPedido: ${cupom.trace_Id}`);\r\n      console.log(`statusCode: ${cupom.statusCode}`);\r\n\r\n      if (cupom.statusCode == 200){\r\n        this.desconto.confirmado = cupom.confirmado;\r\n        return true;\r\n      }else{\r\n        await this.utilService.showAlert('Erro', `Não foi possível confirmar o desconto: ${cupom.errmsg}`);\r\n        return false;\r\n      }       \r\n    } catch (error) {\r\n      console.error('Erro ao confirmar desconto:', error);\r\n\r\n      // Extraia a mensagem de erro correta do objeto error\r\n      let errorMsg = 'Erro desconhecido';\r\n      if (error instanceof HttpErrorResponse) {\r\n        if (error.error && typeof error.error === 'object' && 'errmsg' in error.error) {\r\n          errorMsg = error.error.errmsg;\r\n        } else if (error.message) {\r\n          errorMsg = error.message;\r\n        }\r\n      }\r\n      \r\n      await this.utilService.showAlert('Erro', `Não foi possível confirmar o desconto: ${errorMsg}`);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Cancela Desconto na DidiGlobal\r\n  async cancelaDescontoAPI(){\r\n    const corpo: cancelarPedidoRequest = {\r\n      pedidoId: this.desconto.idpedidodidiglobal,\r\n      Recibo: this.desconto.numerorecibo.toString()\r\n    };\r\n\r\n    try {\r\n      const cupom = await this.pedidoService.cancelarPedido(corpo);\r\n\r\n      console.log(`${JSON.stringify(corpo)}`);\r\n      console.log(`TraceID CancelaDesconto: ${cupom.trace_Id}`);\r\n      console.log(`statusCode: ${cupom.statusCode}`);\r\n\r\n      if (cupom.statusCode = 200){\r\n        this.desconto.cancelado = true;\r\n        return true;\r\n      }else{\r\n        await this.utilService.showAlert('Erro', `Não foi possível cancelar o desconto: ${cupom.errmsg}`);\r\n        return false;\r\n      }      \r\n    } catch (error) {\r\n      console.error('Erro ao cancelar desconto:', error);\r\n\r\n      // Extraia a mensagem de erro correta do objeto error\r\n      let errorMsg = 'Erro desconhecido';\r\n      if (error instanceof HttpErrorResponse) {\r\n        if (error.error && typeof error.error === 'object' && 'errmsg' in error.error) {\r\n          errorMsg = error.error.errmsg;\r\n        } else if (error.message) {\r\n          errorMsg = error.message;\r\n        }\r\n      }\r\n      \r\n      await this.utilService.showAlert('Erro', `Não foi possível cancelar o desconto: ${errorMsg}`);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Gera o Json para Goodsoft\r\n  async gerarDadosRetornoIntegracao(){\r\n    const itensCorpo: GerarDadosRetornoIntegracaoDescontoCombustivelRequest[] = [];\r\n    const itensApi: GerarDadosRetornoIntegracaoPagamentoPedidoRequest[] = []; \r\n    this.SomaTotalDescontoRecebido = 0;\r\n\r\n    for (const itensDescontosTipoPagamento of this.descontosTiposPagamento){\r\n\r\n      const itemApi: GerarDadosRetornoIntegracaoPagamentoPedidoRequest = {\r\n        id: itensDescontosTipoPagamento.id,\r\n        idDesconto : itensDescontosTipoPagamento.iddesconto,\r\n        tipo : itensDescontosTipoPagamento.tipopagamento,\r\n        valor: itensDescontosTipoPagamento.valorpago\r\n      }\r\n\r\n      itensApi.push(itemApi);\r\n    }\r\n\r\n    for (const itensDescontosCombustiveis of this.descontosCombustiveis){\r\n\r\n      const itemCorpo: GerarDadosRetornoIntegracaoDescontoCombustivelRequest = {\r\n        id : itensDescontosCombustiveis.id,\r\n        idDesconto: itensDescontosCombustiveis.iddesconto,\r\n        idCombustivel: itensDescontosCombustiveis.idcombustivel,\r\n        idBomba: itensDescontosCombustiveis.idbomba,\r\n        idBico: itensDescontosCombustiveis.idbico,\r\n        nome: itensDescontosCombustiveis.nome,\r\n        preco: itensDescontosCombustiveis.preco,\r\n        totalLitros: itensDescontosCombustiveis.totallitros,\r\n        totalPrecoCombustivel: itensDescontosCombustiveis.totalprecocombustivel,\r\n        totalDescontoCombustivel: itensDescontosCombustiveis.totaldescontocombustivel,\r\n        totalDescontoRecebidoCombustivel: itensDescontosCombustiveis.totaldescontorecebidocombustivel,\r\n      };\r\n\r\n      this.SomaTotalDescontoRecebido += itensDescontosCombustiveis.totaldescontorecebidocombustivel;\r\n\r\n      itensCorpo.push(itemCorpo);\r\n    }\r\n\r\n    const corpo: GerarDadosRetornoIntegracaoRequest = {\r\n      id: this.desconto.id,\r\n      descontoPagamento: itensApi,\r\n      NomeAtendente: this.desconto.nomeatendente,\r\n      totalPreco: this.desconto.totalpreco,\r\n      totalDesconto : this.desconto.totaldesconto,\r\n      dataHora: this.desconto.datahora,\r\n      recibo: this.desconto.numerorecibo,\r\n      idPedidoDidiGlobal: this.desconto.idpedidodidiglobal,\r\n      codigoDesconto: this.desconto.codigodesconto,\r\n      confirmado: this.desconto.confirmado,\r\n      totalDescontoRecebido: this.SomaTotalDescontoRecebido,\r\n      cancelado: this.desconto.cancelado,\r\n      descontoCombustivel: itensCorpo,\r\n    }\r\n\r\n    console.log(`${JSON.stringify(corpo)}`);\r\n\r\n    try {\r\n      const retornoGerouArquivo = await this.gerarDadosRetornoIntegracaoService.gerarDadosRetorno(corpo);\r\n\r\n      if(!retornoGerouArquivo.arquivoGerado){\r\n        await this.utilService.showAlert('Erro', `Não foi possível gerar o arquivo de retorno JSON`);\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Erro ao gerar retorno:', error);\r\n\r\n      // Extraia a mensagem de erro correta do objeto error\r\n      let errorMsg = 'Erro desconhecido';\r\n      if (error instanceof HttpErrorResponse) {\r\n        if (error.error && typeof error.error === 'object' && 'errmsg' in error.error) {\r\n          errorMsg = error.error.errmsg;\r\n        } else if (error.message) {\r\n          errorMsg = error.message;\r\n        }\r\n      }\r\n      \r\n      await this.utilService.showAlert('Erro', `Não foi possível gerar o arquivo de retorno JSON: ${errorMsg}`);\r\n      return false;\r\n    }\r\n  }\r\n  //#endregion\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CaddescontoPageRoutingModule } from './caddesconto-routing.module';\n\nimport { CaddescontoPage } from './caddesconto.page';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, IonicModule, CaddescontoPageRoutingModule],\n  declarations: [CaddescontoPage]\n})\nexport class CaddescontoPageModule {}\n"],"x_google_ignoreList":[]}